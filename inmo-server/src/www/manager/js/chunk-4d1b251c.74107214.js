(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d1b251c"],{"01c4":function(t,e,a){},"121e":function(t,e,a){"use strict";var s=a("617d"),i=a.n(s);i.a},"613d":function(t,e,a){},"617d":function(t,e,a){},"696f":function(t,e,a){"use strict";var s=a("751a");class i extends s["a"]{getArticleList(){const t=i.getStorage("token");return this.get("/article/list",{auth:{username:t}})}postArticle(t){return this.post("/article",t,{auth:{username:s["a"].getStorage("token")}})}getCategoryList(){return this.get("/category/list")}getTagList(){return this.get("/tag/list")}deleteArticle(t){return this.delete("/article?articleName="+t)}putArticle(t){return this.put("/article",t,{auth:{username:s["a"].getStorage("token")}})}}e["a"]=i},"93d6":function(t,e,a){"use strict";var s=a("cad6"),i=a.n(s);i.a},a93d:function(t,e,a){"use strict";var s=a("da31"),i=a.n(s);i.a},aadb:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"manager-article"},[a("topbar",{attrs:{count:t.count}}),a("article-list",{attrs:{articles:t.dataList},on:{delete:t.onDelete,modify:t.onShowModify}}),a("modify",{attrs:{modifyData:t.modifyData},on:{close:t.onClose,commit:t.onCommit}})],1)},i=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"topbar"},[a("div",{staticClass:"left"},[t._v("文章数目 "),a("span",[t._v(t._s(t.count))])]),a("div",{staticClass:"right"})])},l=[],n={name:"Topbar",props:{count:{type:Number,default:-1}}},r=n,c=(a("e37d"),a("2877")),u=Object(c["a"])(r,o,l,!1,null,"307357a3",null),d=u.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("transition-group",{staticClass:"content",attrs:{name:"animate",tag:"div"}},t._l(t.articles,(function(e){return a("div",{key:e.index,staticClass:"item"},[a("div",{staticClass:"id"},[t._v("ID: "),a("span",{staticClass:"value"},[t._v(t._s(e.index))])]),a("div",{staticClass:"title"},[t._v("文章名称: "),a("span",{staticClass:"value"},[t._v(t._s(e.title))])]),a("div",{staticClass:"author"},[t._v("作者: "),a("span",{staticClass:"value"},[t._v(t._s(e.author))])]),a("div",{staticClass:"category"},[t._v("分类: "),a("span",{staticClass:"value"},[t._v(t._s(e.category))])]),a("div",{staticClass:"tags"},[t._v("标签: "),a("span",{staticClass:"value"},[t._v(t._s(e.tags))])]),a("div",{staticClass:"pubdate"},[t._v("发布时间: "),a("span",{staticClass:"value"},[t._v(t._s(t.pubdateFormat(e.pubdate)))])]),a("div",{staticClass:"control"},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.$emit("modify",e.title)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger"},on:{click:function(a){return t.onDelete(e.title)}}},[t._v("删除")])],1)])})),0)],1)},f=[],p=a("696f");a("01ea");const h=new p["a"];var v={name:"ArticleList",props:{articles:{type:Array,default(){return[]}}},methods:{pubdateFormat(t){const e=new Date(t);return`${e.getFullYear()}年${e.getMonth()+1}月${e.getDate()}日`},onDelete(t){this.$confirm(`确定删除 ${t} ?`,"警告",{closeOnPressEscape:!0,closeOnClickModal:!0,distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"放弃删除",type:"warning"}).then(()=>this.deleteArticle(t)).catch(()=>this.$message({message:"取消删除",type:"info"}))},async deleteArticle(t){const e=await h.deleteArticle(t);0===e.errorCode?(this.$message({message:"删除成功",type:"success"}),this.$emit("delete",t)):this.$message.error(e.message)}}},g=v,y=(a("121e"),Object(c["a"])(g,m,f,!1,null,"2e385aea",null)),b=y.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.visible,title:t.article.title,width:"60%"},on:{"update:visible":function(e){t.visible=e}}},[a("modify-form",{staticClass:"modify-form",attrs:{form:t.article}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.$emit("close")}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.onCommit}},[t._v("修改")])],1)],1)},_=[],$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"ruleForm",staticClass:"modify-container",attrs:{model:t.form}},[a("div",{staticClass:"form-meta"},[a("el-form-item",{staticClass:"meta-item",attrs:{label:"分类",prop:"category"}},[a("el-select",{staticClass:"cate-input",attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"选择获取输入分类"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.cateOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{staticClass:"meta-item",attrs:{label:"标签",prop:"tags"}},[a("el-select",{staticClass:"tag-input",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"选择获取输入标签"},model:{value:t.form.tags,callback:function(e){t.$set(t.form,"tags",e)},expression:"form.tags"}},t._l(t.tagOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{staticClass:"meta-item meta-item-date",attrs:{label:"发布日期",prop:"pubdate"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.form.pubdate,callback:function(e){t.$set(t.form,"pubdate",e)},expression:"form.pubdate"}})],1)],1),a("el-form-item",{staticClass:"meta-item",attrs:{label:"标题",prop:"content"}},[a("el-input",{attrs:{placeholder:"输入文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-form-item",{staticClass:"modify-content",attrs:{prop:"content"}},[a("el-input",{staticClass:"modify-content-area",attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1)},k=[];const x=new p["a"];var D={name:"ModifyForm",props:{form:{type:Object,default(){return{}}}},data(){return{cateOptions:[],tagOptions:[]}},created(){Promise.all([x.getCategoryList(),x.getTagList()]).then(t=>{t[0].forEach(t=>this.cateOptions.push({value:t,label:t})),t[1].forEach(t=>this.tagOptions.push({value:t,label:t}))})}},w=D,A=(a("e193"),Object(c["a"])(w,$,k,!1,null,"4de4dbdc",null)),O=A.exports,L={name:"Mofidy",props:{modifyData:{type:[Object,null],default:null}},components:{ModifyForm:O},watch:{modifyData(t){t&&(t.tags=t.tags.split(","))}},computed:{visible:{get(){return null!==this.modifyData},set(){this.$emit("close")}},article(){return this.visible?this.modifyData:{title:"",content:"",tags:"",category:"",pubdate:""}}},methods:{onCommit(){this.$emit("commit",this.modifyData)}}},j=L,M=(a("93d6"),Object(c["a"])(j,C,_,!1,null,"2dc36050",null)),E=M.exports;a("ac0d");function S(t){if(null===t)return null;if("object"!==typeof t)return t;const e=F(t);let a;if("Object"===e){a={};for(let e in t)a[e]=t[e]}else if("Array"===e){a=[];for(let e in t)a[e]=t[e]}return a}function F(t){return Object.prototype.toString(t).match(/\s(.*)?]/)[1]}const T=new p["a"];var I={name:"ManagerArticle",data(){return{count:0,dataList:[],isModify:!1,modifyData:null}},components:{Topbar:d,ArticleList:b,Modify:E},created(){T.getArticleList().then(({data:t})=>{1007!==t.errorCode&&(this.count=t.length,this.dataList=t)})},methods:{onDelete(t){const e=this.dataList.findIndex(e=>e.title===t);this.dataList.splice(e,1)},onShowModify(t){const e=this.dataList.find(e=>e.title===t),a=S(e);this.modifyData=a},onClose(){this.modifyData=null},async onCommit(t){this.modifyData.tags=this.modifyData.tags.toString();const e=await T.putArticle(this.modifyData);0===e.errorCode?(this.$message({message:"修改成功",type:"success"}),this.updateArticle(t),this.onClose()):this.$message.error("修改失败")},updateArticle(t){const e=this.dataList.findIndex(e=>e.index===t.index);this.dataList.splice(e,1,t)}}},B=I,J=(a("a93d"),Object(c["a"])(B,s,i,!1,null,"b1e04256",null));e["default"]=J.exports},ac0d:function(t,e,a){"use strict"},cad6:function(t,e,a){},da31:function(t,e,a){},e193:function(t,e,a){"use strict";var s=a("613d"),i=a.n(s);i.a},e37d:function(t,e,a){"use strict";var s=a("01c4"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-4d1b251c.74107214.js.map